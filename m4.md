# Module 4: Secure Device Access

## Securing the Network Perimeter

Securing a network begins with hardening the devices that manage it, especially the **edge router**. This device is the critical gateway between your trusted internal network and an untrusted external network like the internet, making it a primary target for attackers.

There are three common architectural approaches to securing the network edge:

| Approach | Description |
| :--- | :--- |
| **Single Router** | A single router connects the internal network to the internet. All security policies are configured on this one device. |
| **Defense-in-Depth** | A multi-layered approach using an edge router, a dedicated firewall, and an internal router. This creates multiple barriers for an attacker to overcome. |
| **DMZ (Demilitarized Zone)** | A buffer network created between an external and internal router, protected by a firewall. It is used to host public-facing servers (like web or email servers) that need to be accessible from the internet without exposing the internal network directly. |

### Holistic Router Security

Effective security requires addressing three key areas:

1.  **Physical Security:** Place routers in a locked, secure room with controlled access and backup power (UPS).
2.  **Operating System Security:** Use the latest, stable version of the device's OS, ensure it has maximum memory to help mitigate DoS attacks, and keep secure backups of OS images and configuration files.
3.  **Device Hardening:** Disable all unused ports and services to reduce the attack surface. Many services are enabled by default and can be exploited by attackers to gather information.

-----

## Foundational Access Security: Passwords

Securing administrative access is critical. The first line of defense is a strong password policy.

### Strong vs. Weak Passwords

A strong password avoids common dictionary words, names, or simple patterns. It should be a complex mix of characters.

| Password Type | Example | Why it's Weak or Strong |
| :--- | :--- | :--- |
| **Weak** | `secret` | Simple dictionary word. |
| **Weak** | `bob1967` | Easily guessable personal information. |
| **Strong** | `b67n42d39c` | A random combination of alphanumeric characters. |
| **Strong** | `12^h u4@1p7` | Combines numbers, letters, symbols, and a space, making it highly complex. |

### Basic Password Configuration (Cisco IOS)

You must secure the three primary access methods on a Cisco device:

1.  **Console Port (Local Access):**
    ```cli
    Switch(config)# line console 0
    Switch(config-line)# password [your_password]
    Switch(config-line)# login
    ```
2.  **Privileged EXEC Mode (Enable Mode):**
    ```cli
    Switch(config)# enable secret [your_strong_password]
    ```
3.  **VTY Lines (Remote Access via Telnet/SSH):**
    ```cli
    Switch(config)# line vty 0 15
    Switch(config-line)# password [your_password]
    Switch(config-line)# login
    ```

### Enhancing Password Security

Beyond setting basic passwords, you should implement these security measures:

  * **Encrypt Plaintext Passwords:** The `service password-encryption` command applies a weak encryption to all unencrypted passwords in the configuration file to prevent them from being viewed as clear text.

    ```cli
    Switch(config)# service password-encryption
    ```

  * **Enforce Minimum Length:** Ensure all newly created passwords meet a minimum length requirement.

    ```cli
    Router(config)# security passwords min-length 10
    ```

  * **Deter Brute-Force Attacks:** This command will lock out login attempts for a specified time after too many failed attempts, thwarting automated password-guessing attacks.

    ```cli
    Router(config)# login block-for 120 attempts 3 within 60
    ```

    *(This blocks logins for 120 seconds if 3 failed attempts occur within 60 seconds.)*

  * **Use Stronger Hashing Algorithms:** By default, the `enable secret` password uses an aging MD5 hash. Modern Cisco IOS versions allow you to use much stronger algorithms like **scrypt (Type 9)** or **sha256 (Type 8)** for both `enable` and local user passwords.

    ```cli
    Router(config)# enable algorithm-type scrypt secret [your_strong_password]
    Router(config)# username admin algorithm-type sha256 secret [your_strong_password]
    ```

-----

## Advanced Login Security and Monitoring

Enhance the security of the login process with legal notifications and proactive monitoring.

  * **Legal Banners:** A Message of the Day (MOTD) banner should be configured to present a legal warning to anyone attempting to access the device. This is crucial for legal purposes.
    ```cli
    Router(config)# banner motd #
    Enter TEXT message. End with the character '#'.
    ****************************************************************
    WARNING: This system is for authorized use only. All activities
    are monitored and recorded. Violators will be prosecuted.
    ****************************************************************
    #
    ```
  * **Login Attempt Delay:** Slow down password-guessing attacks by forcing a delay between each failed login attempt.
    ```cli
    Router(config)# login delay 2
    ```
  * **Logging Login Attempts:** Generate syslog messages for every successful or failed login attempt. This creates an audit trail and can help detect an ongoing attack.
    ```cli
    Router(config)# login on-success log
    Router(config)# login on-failure log
    ```
  * **Verifying Failed Attempts:** You can view a log of failed login attempts directly on the device, including the source IP address of the attacker.
    ```cli
    Router# show login failures
    ```

-----

## Implementing Secure Remote Management with SSH

**Telnet is insecure.** It transmits all data, including usernames and passwords, in plaintext, which can be easily captured by an attacker. **Secure Shell (SSH)** is the industry standard for secure remote management because it encrypts the entire session. For any infrastructure handling sensitive data, like the systems at NexusAI, using SSH is mandatory.

### Six Steps to Configure SSH on a Cisco Router

1.  **Configure a unique hostname.**
2.  **Configure an IP domain name.**
3.  **Generate RSA crypto keys.** (The key length determines the strength of the encryption).
4.  **Create a local user account.**
5.  **Enable VTY lines to use the local user database for login.**
6.  **Enable only SSH for remote connections.**

<!-- end list -->

```cli
Router(config)# hostname R1
R1(config)# ip domain-name nexusai.local
R1(config)# crypto key generate rsa general-keys modulus 2048
R1(config)# username admin secret [your_strong_password]
R1(config)# line vty 0 15
R1(config-line)# login local
R1(config-line)# transport input ssh
```

### Fine-Tuning and Verifying SSH

You can further enhance SSH security and verify its status with these commands:

  * **Adjust SSH Timeout and Retries:** Change the default time allowed to enter a password and the number of attempts permitted.
    ```cli
    R1(config)# ip ssh time-out 60
    R1(config)# ip ssh authentication-retries 2
    ```
  * **Verify SSH Status and Connections:** Check if SSH is enabled and view active connections.
    ```cli
    R1# show ip ssh
    R1# show ssh
    ```
# [Video](https://youtu.be/h5dk3uqoNhk)
