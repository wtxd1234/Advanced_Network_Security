# Module 5: Access Control Lists (ACLs)

## Introduction to Access Control Lists

An **Access Control List (ACL)** is a sequence of permit or deny rules that control which traffic is allowed to pass through a network device. ACLs are a fundamental tool for network security and traffic management, acting as a filter for packets at Layer 3 (Network) and Layer 4 (Transport) of the OSI model.

ACLS are used to perform several critical tasks:

  * **Limit network traffic** to improve performance (e.g., blocking video streams).
  * **Provide traffic flow control** (e.g., restricting routing updates to specific links).
  * **Enforce security policies** (e.g., allowing only the HR department to access the HR servers).
  * **Filter traffic** based on protocol and port number (e.g., permitting email while blocking Telnet).
  * **Screen hosts** to control access to network services.

### ACL Processing: Inbound vs. Outbound

ACLs are applied to a router's interface in a specific direction:

  * **Inbound ACL:** Filters packets as they *enter* an interface, before they are routed. This is efficient because it drops unwanted packets before the router wastes CPU cycles on routing decisions.
  * **Outbound ACL:** Filters packets *after* they have been routed, just before they exit an interface. This is useful when you want to apply the same filter to traffic coming from multiple inbound interfaces that are all leaving through the same outbound interface.

### Standard vs. Extended ACLs

Cisco IOS supports two main types of IPv4 ACLs:

  * **Standard ACLs:** These are the simplest form. They filter traffic based *only* on the **source IPv4 address**. Because they don't offer much granularity, they can't distinguish between traffic types like web and email.
  * **Extended ACLs:** These provide much more control. They can filter traffic based on the **source and destination IPv4 address**, the **protocol** (e.g., TCP, UDP, ICMP), and the **source and destination port numbers**. This allows for very specific rules, such as allowing a specific server to receive web traffic (TCP port 80) but nothing else.

### Numbered vs. Named ACLs

  * **Numbered ACLs:** The traditional way to create ACLs, using a number to identify the list. Standard ACLs use numbers 1-99 and 1300-1999; Extended ACLs use 100-199 and 2000-2699.
  * **Named ACLs:** The modern and preferred method. You assign a descriptive, alphanumeric name (e.g., `FTP-FILTER`) to the ACL, making its purpose much easier to understand.

-----

## Understanding Wildcard Masks

ACLs use **wildcard masks**, not subnet masks, to specify which parts of an IP address to match. They work in the reverse of a subnet mask:

  * A binary `0` in the wildcard mask means "match" the corresponding bit in the IP address.
  * A binary `1` in the wildcard mask means "ignore" the corresponding bit in the IP address.

A simple way to calculate a wildcard mask for a standard subnet is to subtract the subnet mask from `255.255.255.255`.

| Subnet Mask | Calculation | Resulting Wildcard Mask |
| :--- | :--- | :--- |
| `255.255.255.0` | `255.255.255.255` - `255.255.255.0` | `0.0.0.255` |
| `255.255.240.0` | `255.255.255.255` - `255.255.240.0` | `0.0.15.255` |

To simplify ACLs, two keywords are available:

  * **`host`**: Replaces the `0.0.0.0` wildcard mask to match a single, specific IP address.
  * **`any`**: Replaces the `255.255.255.255` wildcard mask to match any IP address.

-----

## Configuring IPv4 ACLs

When writing an ACL, remember that rules are processed from top to bottom. Once a packet matches a rule, processing stops. An invisible **implicit deny** statement (`deny ip any any`) exists at the end of every ACL, so any traffic that doesn't explicitly match a `permit` rule will be dropped.

### Standard ACL Configuration

  * **Named (Recommended):**
    ```cli
    R1(config)# ip access-list standard VTY_ACCESS
    R1(config-std-nacl)# remark Permit only the admin host
    R1(config-std-nacl)# permit host 192.168.10.10
    R1(config-std-nacl)# deny any log
    ```
  * **Numbered:**
    ```cli
    R1(config)# access-list 10 permit host 192.168.10.10
    ```

### Extended ACL Configuration

Extended ACLs allow for very granular control. For a company like NexusAI, an extended ACL could permit external hospital networks to access a specific data portal while denying all other access.

  * **Named (Recommended):**
    ```cli
    R1(config)# ip access-list extended SURFING
    R1(config-ext-nacl)# remark Allow internal users to browse the web
    R1(config-ext-nacl)# permit tcp 192.168.10.0 0.0.0.255 any eq www
    R1(config-ext-nacl)# permit tcp 192.168.10.0 0.0.0.255 any eq 443
    ```
  * **Numbered:**
    ```cli
    R1(config)# access-list 110 permit tcp 192.168.10.0 0.0.0.255 any eq www
    R1(config)# access-list 110 permit tcp 192.168.10.0 0.0.0.255 any eq 443
    ```

-----

## Implementing and Modifying ACLs

### ACL Placement

Where you place an ACL has a significant impact on network performance. The general rules are:

  * **Place extended ACLs as close as possible to the source** of the traffic. This prevents unwanted traffic from crossing the network and consuming bandwidth only to be dropped at its destination.
  * **Place standard ACLs as close as possible to the destination**. Because standard ACLs only filter by source, placing them near the source could inadvertently block traffic destined for other, legitimate locations.

### Applying ACLs

After an ACL is created, it must be applied to an interface or line to take effect.

  * **Apply to an interface:**
    ```cli
    R1(config)# interface gigabitethernet0/0/0
    R1(config-if)# ip access-group SURFING in
    ```
  * **Apply to VTY (remote access) lines:**
    ```cli
    R1(config)# line vty 0 4
    R1(config-line)# access-class VTY_ACCESS in
    ```

### Modifying ACLs

There are two primary methods for editing an ACL:

1.  **Text Editor (Recommended for complex ACLs):** Copy the ACL from the running config, paste it into a text editor, make your changes, remove the old ACL from the router (`no ip access-list...`), and then paste the new version back in.
2.  **Sequence Numbers (for named ACLs):** Named ACLs automatically assign sequence numbers to each line. You can use these numbers to delete a specific line (`no <sequence_number>`) or insert a new line in a specific position (`<sequence_number> permit...`).

-----

## IPv6 ACLs

IPv6 ACLs have some key differences from their IPv4 counterparts:

  * They are **named only**; there are no numbered IPv6 ACLs.
  * There is no equivalent of a "standard" ACL. All IPv6 ACLs are effectively "extended" ACLs.
  * Every IPv6 ACL contains two implicit permit statements at the end to allow for Neighbor Discovery Protocol (NDP) to function, which is essential for IPv6 communication. This is followed by the standard `deny ipv6 any any`.

**Configuration:**

```cli
R1(config)# ipv6 access-list LAN_ONLY
R1(config-ipv6-acl)# permit ipv6 2001:db8:1:1::/64 any
R1(config-ipv6-acl)# deny ipv6 any any
```

**Application:**

```cli
R1(config)# interface gigabitethernet0/0/0
R1(config-if)# ipv6 traffic-filter LAN_ONLY in
```

---

# [Video](https://youtu.be/2SjmxtM3BEo)
